# Use H2 in-memory database for tests to isolate from local MySQL and avoid data conflicts
spring.datasource.url=jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;MODE=MySQL;DB_CLOSE_ON_EXIT=FALSE
spring.datasource.username=sa
spring.datasource.password=
spring.datasource.driver-class-name=org.h2.Driver

# Let Hibernate create the schema for the in-memory DB during tests
# Disable Hibernate automatic DDL in tests; we provide an H2-compatible schema.sql instead
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=true
spring.jpa.open-in-view=false

# Ensure Spring uses JDBC initialization for test profile so test SQL (if present) is applied
## Do not run application-level data.sql during tests â€” it contains MySQL-specific SQL (USE, ON DUPLICATE KEY)
## which breaks the H2 in-memory test DB. Tests manage their own data via repositories/setup.
## Use test SQL initializer to create H2-compatible schema and avoid running main data.sql
spring.sql.init.mode=never

# Avoid loading application's data.sql during tests by ensuring test resources are applied only

# Use H2 dialect and force quoted identifiers so table named `user` (reserved word) works in H2
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.properties.hibernate.globally_quoted_identifiers=true
